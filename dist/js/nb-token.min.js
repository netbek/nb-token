/*
 * nb-token
 * 
 * @author Hein Bekker <hein@netbek.co.za>
 * @copyright (c) 2015 Hein Bekker
 * @license http://www.gnu.org/licenses/agpl-3.0.txt AGPLv3
 */
!function(a,b,c){"use strict";function d(){var a={delimiter:":",defaults:{site:{name:c,slogan:c}}};return{set:function(b){a=g(!0,{},a,b)},$get:function(){return a}}}function e(){var a=!1;return{$get:["$rootScope","$q","_","nbI18N","nbTokenConfig",function(d,e,f,g,h){function i(a,c){var d={};if(b.isObject(a)&&!b.isArray(a))b.isUndefined(c)&&(c=[]),b.forEach(a,function(a,b){f.extend(d,i(a,[].concat(c,b)))});else if(b.isDefined(c)){var e=c.join(h.delimiter);d["["+e+"]"]=g.t("@value",{"@value":a})}return d}function j(a,c){return b.isUndefined(a)?a:(b.isUndefined(c)&&(c=i(d.tokens)),b.isObject(a)?b.forEach(a,function(b,d){a[d]=j(b,c)}):(a=a.toString(),b.forEach(c,function(b,c){a=a.replace(c,b)})),a)}function k(){d.tokens=f.cloneDeep(h.defaults)}return d.$on("$stateChangeStart",function(){k()}),{init:function(){var b=e.defer();return a||(a=!0,k()),b.resolve(!0),b.promise},reset:k,get:function(a,b){return f.get(d.tokens,a,b,h.delimiter)},getAll:function(){return d.tokens},set:function(a,b){return f.set(d.tokens,a,b,h.delimiter)},replace:j,clear:function(a){return f.set(d.tokens,a,c)}}}]}}function f(a){return!!a&&"object"==typeof a&&a.constructor===Object&&!a.nodeType&&a!==a.window}function g(){var a,d,e,h,i,j,k=arguments[0]||{},l=1,m=arguments.length,n=!1;for("boolean"==typeof k&&(n=k,k=arguments[l]||{},l++),f(k)||b.isFunction(k)||(k={}),l===m&&l--;m>l;l++)if(null!=(a=arguments[l]))for(d in a)e=k[d],h=a[d],k!==h&&(n&&h&&(f(h)||(i=b.isArray(h)))?(i?(i=!1,j=e&&b.isArray(e)?e:[]):j=e&&f(e)?e:{},k[d]=g(n,j,h)):h!==c&&(k[d]=h));return k}b.module("nb.token",["nb.lodash","nb.i18n"]).provider("nbToken",e).provider("nbTokenConfig",d)}(window,window.angular);