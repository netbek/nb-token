/*
 * nb-token
 * 
 * @author Hein Bekker <hein@netbek.co.za>
 * @copyright (c) 2015 Hein Bekker
 * @license http://www.gnu.org/licenses/agpl-3.0.txt AGPLv3
 */
!function(a,b,c){"use strict";function d(){var b={delimiter:":",defaults:{site:{name:c,slogan:c}}};return{set:function(c){b=a.merge(!0,b,c)},$get:function(){return b}}}function e(){var a=!1;return{$get:["$rootScope","$q","_","nbTokenConfig",function(d,e,f,g){function h(a,c){var d={};if(b.isObject(a)&&!b.isArray(a))b.isUndefined(c)&&(c=[]),b.forEach(a,function(a,b){f.extend(d,h(a,[].concat(c,b)))});else if(b.isDefined(c)){var e=c.join(g.delimiter);d["["+e+"]"]=a}return d}function i(a,c){if(b.isUndefined(a))return a;var e=h(b.isDefined(c)?c:d.tokens);return j(a,e)}function j(a,c){return b.isUndefined(a)?a:(b.isObject(a)?b.forEach(a,function(b,d){a[d]=j(b,c)}):(a=a.toString(),b.forEach(c,function(c,d){a=a.replace(d,b.isDefined(c)?c:"")})),a)}function k(){d.tokens=f.cloneDeep(g.defaults)}return d.$on("$stateChangeStart",function(){k()}),{init:function(){var b=e.defer();return a||(a=!0,k()),b.resolve(!0),b.promise},reset:k,replace:i,get:function(a,b){return f.get(d.tokens,a,b,g.delimiter)},getAll:function(){return d.tokens},set:function(a,b){return f.set(d.tokens,a,b,g.delimiter)},clear:function(a){return f.set(d.tokens,a,c)}}}]}}b.module("nb.token",["nb.lodash","nb.i18n"]).provider("nbToken",e).provider("nbTokenConfig",d)}(window,window.angular);